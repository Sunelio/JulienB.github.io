;/*FB_PKG_DELIM*/

__d("MAWUploadRetroactiveBackups",["MAWJobDefinitions","MAWTimedJob","Promise","WAJobOrchestratorTypes","isInstamadilloEB"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(){return c("isInstamadilloEB")()?(h||(h=b("Promise"))).resolve():d("MAWTimedJob").TimedUIJobStarters.fireAndForget(d("MAWJobDefinitions").jobSerializers.uploadRetroactiveThreadsAndMessages({priority:d("WAJobOrchestratorTypes").JOB_PRIORITY.LOW}))}g.call=a}),98);
__d("LSUpdateOTCEligibleEBDeviceList",["LSArrayGetObjectAt"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return a[1]?(d[0]=c.i64.of_int32(a[0].length),c.i64.eq(d[0],c.i64.cast([0,0]))?c.sequence([function(a){return d[1]="",c.forEach(c.db.table(261).fetch([[[""]]]),function(a){return a["delete"]()})},function(a){return c.forEach(c.filter(c.db.table(261).fetch([[[d[1]]]]),function(a){return a.deviceId===d[1]&&c.i64.lt(a.authorityLevel,c.i64.cast([0,80]))}),function(a){return a["delete"]()})},function(a){return c.db.table(261).add({deviceId:d[1],authorityLevel:c.i64.cast([0,80])})}]):(d[1]=c.i64.of_int32(a[0].length),c.i64.gt(d[1],c.i64.cast([0,0]))?c.loopAsync(d[1],function(e){return d[2]=e,c.sequence([function(e){return c.nativeTypeOperation("Array",b("LSArrayGetObjectAt"),a[0],d[2]).then(function(a){return a=a,d[3]=a[0],d[4]=a[1],a})},function(a){return d[5]=d[3].get("device_id"),d[3],d[6]=d[3].get("manufacturer"),d[3],d[7]=d[3].get("model"),d[3],d[8]=d[3].get("last_login_location"),d[3],d[9]=d[3].get("last_login_time"),d[3],d[10]=d[3].get("app_id"),d[3],c.forEach(c.filter(c.db.table(261).fetch([[[d[5]]]]),function(a){return a.deviceId===d[5]&&c.i64.lt(a.authorityLevel,c.i64.cast([0,80]))}),function(a){return a["delete"]()})},function(a){return c.db.table(261).add({deviceId:d[5],manufacturer:d[6],model:d[7],lastLoginLocation:d[8],lastLoginTime:d[9],authorityLevel:c.i64.cast([0,80]),appId:d[10]})},function(a){return c.forEach(c.db.table(261).fetch([[[""]]]),function(a){return a["delete"]()})}])}):c.resolve())):c.sequence([function(a){return d[0]="-1",c.forEach(c.db.table(261).fetch([[[""]]]),function(a){return a["delete"]()})},function(a){return c.forEach(c.filter(c.db.table(261).fetch([[[d[0]]]]),function(a){return a.deviceId===d[0]&&c.i64.lt(a.authorityLevel,c.i64.cast([0,80]))}),function(a){return a["delete"]()})},function(a){return c.db.table(261).add({deviceId:d[0],authorityLevel:c.i64.cast([0,80])})}])},function(a){return c.resolve(e)}])}e.exports=a}),null);